<% layout('layouts/layout') %>
<%- include('partials/header') %>

<!-- Converted from checkout.html -->
<!-- ======== Header ======== -->
  <header>
    <div class="logo">Be&gt;Transfer</div>
    <nav>
      <a href="index.html" class="nav-link">Home</a>
      <a href="about.html" class="nav-link">About</a>
      <a href="services.html" class="nav-link">Services</a>
      <a href="contact.html" class="nav-link">Contact</a>
      <span class="support">ðŸ“ž Support: 223-455-566</span>
    </nav>
  </header>

  <!-- ======== Main Form ======== -->
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-8 col-md-10">
        <div class="card shadow p-4">
          <h3 class="text-center text-primary mb-4">ðŸ’¸ Money Transfer Form</h3>

          <form id="checkoutForm">
            <!-- Sender Info -->
            <h5 class="text-secondary">Sender Information</h5>
            <div class="row g-3 mb-4">
              <div class="col-md-6">
                <label for="senderName" class="form-label">Full Name</label>
                <input type="text" id="senderName" class="form-control" required />
              </div>
              <div class="col-md-6">
                <label for="senderEmail" class="form-label">Email</label>
                <input type="email" id="senderEmail" class="form-control" required />
              </div>
              <div class="col-md-6">
                <label for="senderPhone" class="form-label">Phone</label>
                <input type="tel" id="senderPhone" class="form-control" placeholder="+92 3xx xxx xxxx" required />
              </div>
              <div class="col-md-6">
                <label for="senderCountry" class="form-label">Country</label>
                <select id="senderCountry" class="form-select" required>
                  <option value="">Select Country</option>
                  <option>Pakistan</option>
                  <option>UAE</option>
                  <option>UK</option>
                  <option>USA</option>
                </select>
              </div>
            </div>

            <!-- Receiver Info -->
            <h5 class="text-secondary">Receiver Information</h5>
            <div class="row g-3 mb-4">
              <div class="col-md-6">
                <label for="receiverName" class="form-label">Receiver Name</label>
                <input type="text" id="receiverName" class="form-control" required />
              </div>
              <div class="col-md-6">
                <label for="receiverAccount" class="form-label">Account / IBAN</label>
                <input type="text" id="receiverAccount" class="form-control" required />
              </div>
              <div class="col-md-6">
                <label for="receiverCountry" class="form-label">Receiver Country</label>
                <input type="text" id="receiverCountry" class="form-control" required />
              </div>
            </div>

            <!-- Payment -->
            <h5 class="text-secondary">Payment Details</h5>
            <div class="mb-3">
              <div class="form-check">
                <input class="form-check-input" type="radio" name="paymentMethod" id="card" checked />
                <label class="form-check-label" for="card">Card (Credit / Debit)</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="paymentMethod" id="wallet" />
                <label class="form-check-label" for="wallet">Wallet</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="paymentMethod" id="cash" />
                <label class="form-check-label" for="cash">Cash Deposit</label>
              </div>
            </div>

            <div id="cardDetails" class="border rounded-3 p-3 mb-4">
              <div class="row g-3">
                <div class="col-md-6">
                  <label for="cardNumber" class="form-label">Card Number</label>
                  <input type="text" id="cardNumber" class="form-control" placeholder="16-digit card number" />
                </div>
                <div class="col-md-3">
                  <label for="expiry" class="form-label">Expiry (MM/YY)</label>
                  <input type="text" id="expiry" class="form-control" placeholder="MM/YY" />
                </div>
                <div class="col-md-3">
                  <label for="cvv" class="form-label">CVV</label>
                  <input type="password" id="cvv" class="form-control" placeholder="123" />
                </div>
              </div>
            </div>

            <div class="mb-3">
              <label for="amount" class="form-label">Amount (PKR)</label>
              <input type="number" id="amount" class="form-control" min="1" placeholder="Enter amount to transfer" required />
            </div>

            <div class="form-check mb-3">
              <input class="form-check-input" type="checkbox" id="agree" />
              <label class="form-check-label" for="agree">I agree to the terms & conditions</label>
            </div>

            <div class="d-grid">
              <button type="submit" class="btn btn-custom" id="placeOrderBtn" disabled>Transfer Money</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- ======== Script ======== -->
  <script>
    $(document).ready(function () {
      console.log("âœ… jQuery Loaded");

      // Highlight inputs on focus
      $("input, select").focus(function () {
        $(this).css("background-color", "#e0f2fe");
      }).blur(function () {
        $(this).css("background-color", "white");
      });

      // Toggle card details
      $("input[name='paymentMethod']").change(function () {
        if ($("#card").is(":checked")) {
          $("#cardDetails").slideDown();
        } else {
          $("#cardDetails").slideUp();
        }
      });

      // Enable button when terms accepted
      $("#agree").change(function () {
        $("#placeOrderBtn").prop("disabled", !this.checked);
      });

      // Submit form
      $("#checkoutForm").submit(function (e) {
        e.preventDefault();

        // Validate required fields
        const senderName = $("#senderName").val().trim();
        const senderEmail = $("#senderEmail").val().trim();
        const amount = $("#amount").val().trim();

        if (senderName === "" || senderEmail === "" || amount === "") {
          alert("âš ï¸ Please fill all required fields!");
          return;
        }

        if ($("#card").is(":checked")) {
          const cardNumber = $("#cardNumber").val().trim();
          const expiry = $("#expiry").val().trim();
          const cvv = $("#cvv").val().trim();

          if (!/^\d{16}$/.test(cardNumber)) return alert("âš ï¸ Enter valid 16-digit card number!");
          if (!/^(0[1-9]|1[0-2])\/\d{2}$/.test(expiry)) return alert("âš ï¸ Enter valid expiry (MM/YY)!");
          if (!/^\d{3}$/.test(cvv)) return alert("âš ï¸ Enter valid 3-digit CVV!");
        }

        // Save details to localStorage
        const transactionId = "BTX" + Math.floor(100000 + Math.random() * 900000);
        const today = new Date().toLocaleDateString('en-GB', { day: '2-digit', month: 'long', year: 'numeric' });

        localStorage.setItem("customerName", senderName);
        localStorage.setItem("customerEmail", senderEmail);
        localStorage.setItem("amount", amount);
        localStorage.setItem("transactionId", transactionId);
        localStorage.setItem("transactionDate", today);

        $("#placeOrderBtn").text("Processing...").css("background-color", "#f97316");

        setTimeout(() => {
          window.location.href = "success.html";
        }, 800);
      });
    });
  </script>
<%- include('partials/footer') %>
